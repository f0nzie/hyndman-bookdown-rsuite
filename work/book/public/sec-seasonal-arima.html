<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>8.9 Seasonal ARIMA models | Forecasting: Principles and Practice</title>
  <meta name="description" content="2nd edition" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="8.9 Seasonal ARIMA models | Forecasting: Principles and Practice" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://Otexts.org/fpp2/" />
  <meta property="og:image" content="http://Otexts.org/fpp2/fppcover.jpg" />
  <meta property="og:description" content="2nd edition" />
  <meta name="github-repo" content="robjhyndman/fpp2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="8.9 Seasonal ARIMA models | Forecasting: Principles and Practice" />
  <meta name="twitter:site" content="@robjhyndman" />
  <meta name="twitter:description" content="2nd edition" />
  <meta name="twitter:image" content="http://Otexts.org/fpp2/fppcover.jpg" />

<meta name="author" content="Rob J Hyndman" />
<meta name="author" content="George Athanasopoulos" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="forecasting.html">
<link rel="next" href="arima-vs-ets.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { 
    equationNumbers: { autoNumber: "AMS" } ,
    Macros: {
      bm: ["\\boldsymbol{#1}",1],
      y:    ["y_{\\text{#1},#2}",2],
      yhat: ["\\hat{y}_{\\text{#1},#2}",2],
      ytilde: ["\\tilde{y}_{\\text{#1},#2}",2],
      Shat: ["\\hat{S}_{\\text{#1},#2}^{(#3)}",3]
    }
  }
});
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Forecasting: Principles and Practice</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="ch-intro.html"><a href="ch-intro.html"><i class="fa fa-check"></i><b>1</b> Getting started</a><ul>
<li class="chapter" data-level="1.1" data-path="what-can-be-forecast.html"><a href="what-can-be-forecast.html"><i class="fa fa-check"></i><b>1.1</b> What can be forecast?</a></li>
<li class="chapter" data-level="1.2" data-path="sec-1-2-ForPlanGoals.html"><a href="sec-1-2-ForPlanGoals.html"><i class="fa fa-check"></i><b>1.2</b> Forecasting, planning and goals</a></li>
<li class="chapter" data-level="1.3" data-path="determining-what-to-forecast.html"><a href="determining-what-to-forecast.html"><i class="fa fa-check"></i><b>1.3</b> Determining what to forecast</a></li>
<li class="chapter" data-level="1.4" data-path="Intro-DataAndMethods.html"><a href="Intro-DataAndMethods.html"><i class="fa fa-check"></i><b>1.4</b> Forecasting data and methods</a></li>
<li class="chapter" data-level="1.5" data-path="case-studies.html"><a href="case-studies.html"><i class="fa fa-check"></i><b>1.5</b> Some case studies</a></li>
<li class="chapter" data-level="1.6" data-path="the-basic-steps-in-a-forecasting-task.html"><a href="the-basic-steps-in-a-forecasting-task.html"><i class="fa fa-check"></i><b>1.6</b> The basic steps in a forecasting task</a></li>
<li class="chapter" data-level="1.7" data-path="sec-perspective.html"><a href="sec-perspective.html"><i class="fa fa-check"></i><b>1.7</b> The statistical forecasting perspective</a></li>
<li class="chapter" data-level="1.8" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.8</b> Exercises</a></li>
<li class="chapter" data-level="1.9" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>1.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-graphics.html"><a href="ch-graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a><ul>
<li class="chapter" data-level="2.1" data-path="ts-objects.html"><a href="ts-objects.html"><i class="fa fa-check"></i><b>2.1</b> <code>ts</code> objects</a></li>
<li class="chapter" data-level="2.2" data-path="time-plots.html"><a href="time-plots.html"><i class="fa fa-check"></i><b>2.2</b> Time plots</a></li>
<li class="chapter" data-level="2.3" data-path="tspatterns.html"><a href="tspatterns.html"><i class="fa fa-check"></i><b>2.3</b> Time series patterns</a></li>
<li class="chapter" data-level="2.4" data-path="seasonal-plots.html"><a href="seasonal-plots.html"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a></li>
<li class="chapter" data-level="2.5" data-path="seasonal-subseries-plots.html"><a href="seasonal-subseries-plots.html"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a></li>
<li class="chapter" data-level="2.6" data-path="scatterplots.html"><a href="scatterplots.html"><i class="fa fa-check"></i><b>2.6</b> Scatterplots</a></li>
<li class="chapter" data-level="2.7" data-path="lag-plots.html"><a href="lag-plots.html"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a></li>
<li class="chapter" data-level="2.8" data-path="autocorrelation.html"><a href="autocorrelation.html"><i class="fa fa-check"></i><b>2.8</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.9" data-path="wn.html"><a href="wn.html"><i class="fa fa-check"></i><b>2.9</b> White noise</a></li>
<li class="chapter" data-level="2.10" data-path="ex-graphics.html"><a href="ex-graphics.html"><i class="fa fa-check"></i><b>2.10</b> Exercises</a></li>
<li class="chapter" data-level="2.11" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>2.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-toolbox.html"><a href="ch-toolbox.html"><i class="fa fa-check"></i><b>3</b> The forecaster’s toolbox</a><ul>
<li class="chapter" data-level="3.1" data-path="sec-2-methods.html"><a href="sec-2-methods.html"><i class="fa fa-check"></i><b>3.1</b> Some simple forecasting methods</a></li>
<li class="chapter" data-level="3.2" data-path="sec-transformations.html"><a href="sec-transformations.html"><i class="fa fa-check"></i><b>3.2</b> Transformations and adjustments</a></li>
<li class="chapter" data-level="3.3" data-path="residuals.html"><a href="residuals.html"><i class="fa fa-check"></i><b>3.3</b> Residual diagnostics</a></li>
<li class="chapter" data-level="3.4" data-path="accuracy.html"><a href="accuracy.html"><i class="fa fa-check"></i><b>3.4</b> Evaluating forecast accuracy</a></li>
<li class="chapter" data-level="3.5" data-path="sec-PI.html"><a href="sec-PI.html"><i class="fa fa-check"></i><b>3.5</b> Prediction intervals</a></li>
<li class="chapter" data-level="3.6" data-path="the-forecast-package-in-r.html"><a href="the-forecast-package-in-r.html"><i class="fa fa-check"></i><b>3.6</b> The forecast package in R</a></li>
<li class="chapter" data-level="3.7" data-path="ex-toolbox.html"><a href="ex-toolbox.html"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
<li class="chapter" data-level="3.8" data-path="further-reading-2.html"><a href="further-reading-2.html"><i class="fa fa-check"></i><b>3.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-judgmental.html"><a href="ch-judgmental.html"><i class="fa fa-check"></i><b>4</b> Judgmental forecasts</a><ul>
<li class="chapter" data-level="4.1" data-path="sec-3-limitations.html"><a href="sec-3-limitations.html"><i class="fa fa-check"></i><b>4.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="4.2" data-path="sec-3-Key-principles.html"><a href="sec-3-Key-principles.html"><i class="fa fa-check"></i><b>4.2</b> Key principles</a></li>
<li class="chapter" data-level="4.3" data-path="sec-3-Delphi.html"><a href="sec-3-Delphi.html"><i class="fa fa-check"></i><b>4.3</b> The Delphi method</a></li>
<li class="chapter" data-level="4.4" data-path="sec-3-Analogy.html"><a href="sec-3-Analogy.html"><i class="fa fa-check"></i><b>4.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="4.5" data-path="sec-3-Scenario.html"><a href="sec-3-Scenario.html"><i class="fa fa-check"></i><b>4.5</b> Scenario Forecasting</a></li>
<li class="chapter" data-level="4.6" data-path="sec-3-NPF.html"><a href="sec-3-NPF.html"><i class="fa fa-check"></i><b>4.6</b> New product forecasting</a></li>
<li class="chapter" data-level="4.7" data-path="sec-3-Adjustments.html"><a href="sec-3-Adjustments.html"><i class="fa fa-check"></i><b>4.7</b> Judgmental adjustments</a></li>
<li class="chapter" data-level="4.8" data-path="further-reading-3.html"><a href="further-reading-3.html"><i class="fa fa-check"></i><b>4.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-regression.html"><a href="ch-regression.html"><i class="fa fa-check"></i><b>5</b> Linear regression models</a><ul>
<li class="chapter" data-level="5.1" data-path="Regr-Intro.html"><a href="Regr-Intro.html"><i class="fa fa-check"></i><b>5.1</b> The linear model</a></li>
<li class="chapter" data-level="5.2" data-path="Regr-LSprinciple.html"><a href="Regr-LSprinciple.html"><i class="fa fa-check"></i><b>5.2</b> Least squares estimation</a></li>
<li class="chapter" data-level="5.3" data-path="Regr-UsefulPredictors.html"><a href="Regr-UsefulPredictors.html"><i class="fa fa-check"></i><b>5.3</b> Some useful predictors</a></li>
<li class="chapter" data-level="5.4" data-path="Regr-EvaluatingSLR.html"><a href="Regr-EvaluatingSLR.html"><i class="fa fa-check"></i><b>5.4</b> Evaluating the regression model</a></li>
<li class="chapter" data-level="5.5" data-path="Regr-SelectingPredictors.html"><a href="Regr-SelectingPredictors.html"><i class="fa fa-check"></i><b>5.5</b> Selecting predictors</a></li>
<li class="chapter" data-level="5.6" data-path="Regr-ForeWithRegr.html"><a href="Regr-ForeWithRegr.html"><i class="fa fa-check"></i><b>5.6</b> Forecasting with regression</a></li>
<li class="chapter" data-level="5.7" data-path="Regr-MatrixEquations.html"><a href="Regr-MatrixEquations.html"><i class="fa fa-check"></i><b>5.7</b> Matrix formulation</a></li>
<li class="chapter" data-level="5.8" data-path="Regr-NonLinear.html"><a href="Regr-NonLinear.html"><i class="fa fa-check"></i><b>5.8</b> Nonlinear regression</a></li>
<li class="chapter" data-level="5.9" data-path="Regr-MultiCol.html"><a href="Regr-MultiCol.html"><i class="fa fa-check"></i><b>5.9</b> Correlation, causation and forecasting</a></li>
<li class="chapter" data-level="5.10" data-path="Regr-exercises.html"><a href="Regr-exercises.html"><i class="fa fa-check"></i><b>5.10</b> Exercises</a></li>
<li class="chapter" data-level="5.11" data-path="further-reading-4.html"><a href="further-reading-4.html"><i class="fa fa-check"></i><b>5.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-decomposition.html"><a href="ch-decomposition.html"><i class="fa fa-check"></i><b>6</b> Time series decomposition</a><ul>
<li class="chapter" data-level="6.1" data-path="sec-6-1-TSpatterns.html"><a href="sec-6-1-TSpatterns.html"><i class="fa fa-check"></i><b>6.1</b> Time series components</a></li>
<li class="chapter" data-level="6.2" data-path="moving-averages.html"><a href="moving-averages.html"><i class="fa fa-check"></i><b>6.2</b> Moving averages</a></li>
<li class="chapter" data-level="6.3" data-path="classical-decomposition.html"><a href="classical-decomposition.html"><i class="fa fa-check"></i><b>6.3</b> Classical decomposition</a></li>
<li class="chapter" data-level="6.4" data-path="x11-decomposition.html"><a href="x11-decomposition.html"><i class="fa fa-check"></i><b>6.4</b> X11 decomposition</a></li>
<li class="chapter" data-level="6.5" data-path="seats-decomposition.html"><a href="seats-decomposition.html"><i class="fa fa-check"></i><b>6.5</b> SEATS decomposition</a></li>
<li class="chapter" data-level="6.6" data-path="sec-6-stl.html"><a href="sec-6-stl.html"><i class="fa fa-check"></i><b>6.6</b> STL decomposition</a></li>
<li class="chapter" data-level="6.7" data-path="forecasting-with-decomposition.html"><a href="forecasting-with-decomposition.html"><i class="fa fa-check"></i><b>6.7</b> Forecasting with decomposition</a></li>
<li class="chapter" data-level="6.8" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>6.8</b> Exercises</a></li>
<li class="chapter" data-level="6.9" data-path="further-reading-5.html"><a href="further-reading-5.html"><i class="fa fa-check"></i><b>6.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-expsmooth.html"><a href="ch-expsmooth.html"><i class="fa fa-check"></i><b>7</b> Exponential smoothing</a><ul>
<li class="chapter" data-level="7.1" data-path="sec-7-1-SES.html"><a href="sec-7-1-SES.html"><i class="fa fa-check"></i><b>7.1</b> Simple exponential smoothing</a></li>
<li class="chapter" data-level="7.2" data-path="sec-7-trendmethods.html"><a href="sec-7-trendmethods.html"><i class="fa fa-check"></i><b>7.2</b> Trend methods</a></li>
<li class="chapter" data-level="7.3" data-path="sec-7-Taxonomy.html"><a href="sec-7-Taxonomy.html"><i class="fa fa-check"></i><b>7.3</b> Holt-Winters’ seasonal method</a></li>
<li class="chapter" data-level="7.4" data-path="sec-7-6-Taxonomy.html"><a href="sec-7-6-Taxonomy.html"><i class="fa fa-check"></i><b>7.4</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="7.5" data-path="sec-7-ETS.html"><a href="sec-7-ETS.html"><i class="fa fa-check"></i><b>7.5</b> Innovations state space models for exponential smoothing</a></li>
<li class="chapter" data-level="7.6" data-path="estimation-and-model-selection.html"><a href="estimation-and-model-selection.html"><i class="fa fa-check"></i><b>7.6</b> Estimation and model selection</a></li>
<li class="chapter" data-level="7.7" data-path="forecasting-with-ets-models.html"><a href="forecasting-with-ets-models.html"><i class="fa fa-check"></i><b>7.7</b> Forecasting with ETS models</a></li>
<li class="chapter" data-level="7.8" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
<li class="chapter" data-level="7.9" data-path="further-reading-6.html"><a href="further-reading-6.html"><i class="fa fa-check"></i><b>7.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch-arima.html"><a href="ch-arima.html"><i class="fa fa-check"></i><b>8</b> ARIMA models</a><ul>
<li class="chapter" data-level="8.1" data-path="stationarity-and-differencing.html"><a href="stationarity-and-differencing.html"><i class="fa fa-check"></i><b>8.1</b> Stationarity and differencing</a></li>
<li class="chapter" data-level="8.2" data-path="backshift-notation.html"><a href="backshift-notation.html"><i class="fa fa-check"></i><b>8.2</b> Backshift notation</a></li>
<li class="chapter" data-level="8.3" data-path="autoregressive-models.html"><a href="autoregressive-models.html"><i class="fa fa-check"></i><b>8.3</b> Autoregressive models</a></li>
<li class="chapter" data-level="8.4" data-path="sec-mamodels.html"><a href="sec-mamodels.html"><i class="fa fa-check"></i><b>8.4</b> Moving average models</a></li>
<li class="chapter" data-level="8.5" data-path="sec-nonseasonalarima.html"><a href="sec-nonseasonalarima.html"><i class="fa fa-check"></i><b>8.5</b> Non-seasonal ARIMA models</a></li>
<li class="chapter" data-level="8.6" data-path="estimation-and-order-selection.html"><a href="estimation-and-order-selection.html"><i class="fa fa-check"></i><b>8.6</b> Estimation and order selection</a></li>
<li class="chapter" data-level="8.7" data-path="arima-modelling-in-r.html"><a href="arima-modelling-in-r.html"><i class="fa fa-check"></i><b>8.7</b> ARIMA modelling in R</a></li>
<li class="chapter" data-level="8.8" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>8.8</b> Forecasting</a></li>
<li class="chapter" data-level="8.9" data-path="sec-seasonal-arima.html"><a href="sec-seasonal-arima.html"><i class="fa fa-check"></i><b>8.9</b> Seasonal ARIMA models</a></li>
<li class="chapter" data-level="8.10" data-path="arima-vs-ets.html"><a href="arima-vs-ets.html"><i class="fa fa-check"></i><b>8.10</b> ARIMA vs ETS</a></li>
<li class="chapter" data-level="8.11" data-path="exercises-3.html"><a href="exercises-3.html"><i class="fa fa-check"></i><b>8.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-dynamic.html"><a href="ch-dynamic.html"><i class="fa fa-check"></i><b>9</b> Dynamic regression models</a><ul>
<li class="chapter" data-level="9.1" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>9.1</b> Estimation</a></li>
<li class="chapter" data-level="9.2" data-path="regression-with-arima-errors-in-r.html"><a href="regression-with-arima-errors-in-r.html"><i class="fa fa-check"></i><b>9.2</b> Regression with ARIMA errors in R</a></li>
<li class="chapter" data-level="9.3" data-path="forecasting-1.html"><a href="forecasting-1.html"><i class="fa fa-check"></i><b>9.3</b> Forecasting</a></li>
<li class="chapter" data-level="9.4" data-path="stochastic-and-deterministic-trends.html"><a href="stochastic-and-deterministic-trends.html"><i class="fa fa-check"></i><b>9.4</b> Stochastic and deterministic trends</a></li>
<li class="chapter" data-level="9.5" data-path="sec-dhr.html"><a href="sec-dhr.html"><i class="fa fa-check"></i><b>9.5</b> Dynamic harmonic regression</a></li>
<li class="chapter" data-level="9.6" data-path="lagged-predictors.html"><a href="lagged-predictors.html"><i class="fa fa-check"></i><b>9.6</b> Lagged predictors</a></li>
<li class="chapter" data-level="9.7" data-path="exercises-4.html"><a href="exercises-4.html"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
<li class="chapter" data-level="9.8" data-path="further-reading-7.html"><a href="further-reading-7.html"><i class="fa fa-check"></i><b>9.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html"><i class="fa fa-check"></i><b>10</b> Forecasting hierarchical or grouped time series</a><ul>
<li class="chapter" data-level="10.1" data-path="Hier-hierarchical-ts.html"><a href="Hier-hierarchical-ts.html"><i class="fa fa-check"></i><b>10.1</b> Hierarchical time series</a></li>
<li class="chapter" data-level="10.2" data-path="Hier-grouped-ts.html"><a href="Hier-grouped-ts.html"><i class="fa fa-check"></i><b>10.2</b> Grouped time series</a></li>
<li class="chapter" data-level="10.3" data-path="Hier-base-coherent-forecasts.html"><a href="Hier-base-coherent-forecasts.html"><i class="fa fa-check"></i><b>10.3</b> Base and coherent forecasts</a></li>
<li class="chapter" data-level="10.4" data-path="Hier-bu.html"><a href="Hier-bu.html"><i class="fa fa-check"></i><b>10.4</b> The bottom-up approach</a></li>
<li class="chapter" data-level="10.5" data-path="Hier-td.html"><a href="Hier-td.html"><i class="fa fa-check"></i><b>10.5</b> Top-down approaches</a></li>
<li class="chapter" data-level="10.6" data-path="Hier-mo.html"><a href="Hier-mo.html"><i class="fa fa-check"></i><b>10.6</b> Middle-out approach</a></li>
<li class="chapter" data-level="10.7" data-path="Hier-projection.html"><a href="Hier-projection.html"><i class="fa fa-check"></i><b>10.7</b> The projection matrix</a></li>
<li class="chapter" data-level="10.8" data-path="Hier-reconciliation.html"><a href="Hier-reconciliation.html"><i class="fa fa-check"></i><b>10.8</b> The optimal reconciliation approach</a></li>
<li class="chapter" data-level="10.9" data-path="ex-hierarchical.html"><a href="ex-hierarchical.html"><i class="fa fa-check"></i><b>10.9</b> Exercises</a></li>
<li class="chapter" data-level="10.10" data-path="further-reading-8.html"><a href="further-reading-8.html"><i class="fa fa-check"></i><b>10.10</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch-advanced.html"><a href="ch-advanced.html"><i class="fa fa-check"></i><b>11</b> Advanced forecasting methods</a><ul>
<li class="chapter" data-level="11.1" data-path="sec-complexseasonality.html"><a href="sec-complexseasonality.html"><i class="fa fa-check"></i><b>11.1</b> Complex seasonality</a></li>
<li class="chapter" data-level="11.2" data-path="forecasting-counts.html"><a href="forecasting-counts.html"><i class="fa fa-check"></i><b>11.2</b> Forecasting counts</a></li>
<li class="chapter" data-level="11.3" data-path="VAR.html"><a href="VAR.html"><i class="fa fa-check"></i><b>11.3</b> Vector autoregressions</a></li>
<li class="chapter" data-level="11.4" data-path="sec-9-3-nnet.html"><a href="sec-9-3-nnet.html"><i class="fa fa-check"></i><b>11.4</b> Neural network models</a></li>
<li class="chapter" data-level="11.5" data-path="sec-ex-11.html"><a href="sec-ex-11.html"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch-practical.html"><a href="ch-practical.html"><i class="fa fa-check"></i><b>12</b> Some practical forecasting issues</a><ul>
<li class="chapter" data-level="12.1" data-path="weekly.html"><a href="weekly.html"><i class="fa fa-check"></i><b>12.1</b> Weekly, daily and sub-daily data</a></li>
<li class="chapter" data-level="12.2" data-path="counts.html"><a href="counts.html"><i class="fa fa-check"></i><b>12.2</b> Time series of counts</a></li>
<li class="chapter" data-level="12.3" data-path="limits.html"><a href="limits.html"><i class="fa fa-check"></i><b>12.3</b> Ensuring forecasts stay within limits</a></li>
<li class="chapter" data-level="12.4" data-path="combinations.html"><a href="combinations.html"><i class="fa fa-check"></i><b>12.4</b> Forecast combinations</a></li>
<li class="chapter" data-level="12.5" data-path="aggregates.html"><a href="aggregates.html"><i class="fa fa-check"></i><b>12.5</b> Prediction intervals for aggregates</a></li>
<li class="chapter" data-level="12.6" data-path="backcasting.html"><a href="backcasting.html"><i class="fa fa-check"></i><b>12.6</b> Backcasting</a></li>
<li class="chapter" data-level="12.7" data-path="short-ts.html"><a href="short-ts.html"><i class="fa fa-check"></i><b>12.7</b> Forecasting very short time series</a></li>
<li class="chapter" data-level="12.8" data-path="long-ts.html"><a href="long-ts.html"><i class="fa fa-check"></i><b>12.8</b> Forecasting very long time series</a></li>
<li class="chapter" data-level="12.9" data-path="oosos.html"><a href="oosos.html"><i class="fa fa-check"></i><b>12.9</b> One-step forecasts on test data</a></li>
<li class="chapter" data-level="12.10" data-path="isms.html"><a href="isms.html"><i class="fa fa-check"></i><b>12.10</b> Multi-step forecasts on training data</a></li>
<li class="chapter" data-level="12.11" data-path="missing-outliers.html"><a href="missing-outliers.html"><i class="fa fa-check"></i><b>12.11</b> Dealing with missing values and outliers</a></li>
<li class="chapter" data-level="12.12" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>12.12</b> Bootstrapping and bagging</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="using-r.html"><a href="using-r.html"><i class="fa fa-check"></i>Using R</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://OTexts.org" target="blank">Published by OTexts with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting: Principles and Practice</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec-seasonal-arima" class="section level2">
<h2><span class="header-section-number">8.9</span> Seasonal ARIMA models</h2>
<p>So far, we have restricted our attention to non-seasonal data and non-seasonal ARIMA models. However, ARIMA models are also capable of modelling a wide range of seasonal data.</p>
<p>A seasonal ARIMA model is formed by including additional seasonal terms in the ARIMA models we have seen so far. It is written as follows:</p>
<table>
<thead>
<tr class="header">
<th align="right">ARIMA</th>
<th align="center"><span class="math inline">\(~\underbrace{(p, d, q)}\)</span></th>
<th align="center"><span class="math inline">\(\underbrace{(P, D, Q)_{m}}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right"></td>
<td align="center"><span class="math inline">\({\uparrow}\)</span></td>
<td align="center"><span class="math inline">\({\uparrow}\)</span></td>
</tr>
<tr class="even">
<td align="right"></td>
<td align="center">Non-seasonal part</td>
<td align="center">Seasonal part of</td>
</tr>
<tr class="odd">
<td align="right"></td>
<td align="center">of the model</td>
<td align="center">of the model</td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(m =\)</span> number of observations per year. We use uppercase notation for the seasonal parts of the model, and lowercase notation for the non-seasonal parts of the model.</p>
<p>The seasonal part of the model consists of terms that are very similar to the non-seasonal components of the model, but involve backshifts of the seasonal period. For example, an ARIMA(1,1,1)(1,1,1)<span class="math inline">\(_{4}\)</span> model (without a constant) is for quarterly data (<span class="math inline">\(m=4\)</span>), and can be written as
<span class="math display">\[
  (1 - \phi_{1}B)~(1 - \Phi_{1}B^{4}) (1 - B) (1 - B^{4})y_{t} =
  (1 + \theta_{1}B)~ (1 + \Theta_{1}B^{4})e_{t}.
\]</span></p>
<p>The additional seasonal terms are simply multiplied by the non-seasonal terms.</p>
<div id="acfpacf" class="section level3 unnumbered">
<h3>ACF/PACF</h3>
<p>The seasonal part of an AR or MA model will be seen in the seasonal lags of the PACF and ACF. For example, an ARIMA(0,0,0)(0,0,1)<span class="math inline">\(_{12}\)</span> model will show:</p>
<ul>
<li>a spike at lag 12 in the ACF but no other significant spikes;</li>
<li>exponential decay in the seasonal lags of the PACF (i.e., at lags 12, 24, 36, …).</li>
</ul>
<p>Similarly, an ARIMA(0,0,0)(1,0,0)<span class="math inline">\(_{12}\)</span> model will show:</p>
<ul>
<li>exponential decay in the seasonal lags of the ACF;</li>
<li>a single significant spike at lag 12 in the PACF.</li>
</ul>
<p>In considering the appropriate seasonal orders for an ARIMA model, restrict attention to the seasonal lags.</p>
<p>The modelling procedure is almost the same as for non-seasonal data, except that we need to select seasonal AR and MA terms as well as the non-seasonal components of the model. The process is best illustrated via examples.</p>
</div>
<div id="example-european-quarterly-retail-trade" class="section level3 unnumbered">
<h3>Example: European quarterly retail trade</h3>
<p>We will describe the seasonal ARIMA modelling procedure using quarterly European retail trade data from 1996 to 2011. The data are plotted in Figure <a href="sec-seasonal-arima.html#fig:euretail1">8.15</a>.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" data-line-number="1"><span class="kw">autoplot</span>(euretail) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Retail index&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:euretail1"></span>
<img src="fpp_files/figure-html/euretail1-1.png" alt="Quarterly retail trade index in the Euro area (17 countries), 1996--2011, covering wholesale and retail trade, and the repair of motor vehicles and motorcycles. (Index: 2005 = 100)." width="90%" />
<p class="caption">
Figure 8.15: Quarterly retail trade index in the Euro area (17 countries), 1996–2011, covering wholesale and retail trade, and the repair of motor vehicles and motorcycles. (Index: 2005 = 100).
</p>
</div>
<p>The data are clearly non-stationary, with some seasonality, so we will first take a seasonal difference. The seasonally differenced data are shown in Figure <a href="sec-seasonal-arima.html#fig:euretail2">8.16</a>. These also appear to be non-stationary, so we take an additional first difference, shown in Figure <a href="sec-seasonal-arima.html#fig:euretail3">8.17</a>.</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" data-line-number="1">euretail <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">diff</span>(<span class="dt">lag=</span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span>ggtsdisplay</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:euretail2"></span>
<img src="fpp_files/figure-html/euretail2-1.png" alt="Seasonally differenced European retail trade index." width="90%" />
<p class="caption">
Figure 8.16: Seasonally differenced European retail trade index.
</p>
</div>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" data-line-number="1">euretail <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">diff</span>(<span class="dt">lag=</span><span class="dv">4</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">diff</span>() <span class="op">%&gt;%</span><span class="st"> </span>ggtsdisplay</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:euretail3"></span>
<img src="fpp_files/figure-html/euretail3-1.png" alt="Double differenced European retail trade index." width="90%" />
<p class="caption">
Figure 8.17: Double differenced European retail trade index.
</p>
</div>
<p>Our aim now is to find an appropriate ARIMA model based on the ACF and PACF shown in Figure <a href="sec-seasonal-arima.html#fig:euretail3">8.17</a>. The significant spike at lag 1 in the ACF suggests a non-seasonal MA(1) component, and the significant spike at lag 4 in the ACF suggests a seasonal MA(1) component. Consequently, we begin with an ARIMA(0,1,1)(0,1,1)<span class="math inline">\(_4\)</span> model, indicating a first and seasonal difference, and non-seasonal and seasonal MA(1) components. The residuals for the fitted model are shown in Figure <a href="sec-seasonal-arima.html#fig:euretail4">8.18</a>. (By analogous logic applied to the PACF, we could also have started with an ARIMA(1,1,0)(1,1,0)<span class="math inline">\(_4\)</span> model.)</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" data-line-number="1">euretail <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb151-2" data-line-number="2"><span class="st">  </span><span class="kw">Arima</span>(<span class="dt">order=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">seasonal=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb151-3" data-line-number="3"><span class="st">  </span>residuals <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb151-4" data-line-number="4"><span class="st">  </span>ggtsdisplay</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:euretail4"></span>
<img src="fpp_files/figure-html/euretail4-1.png" alt="Residuals from the fitted ARIMA(0,1,3)(0,1,1)$_4$ model for the European retail trade index data." width="90%" />
<p class="caption">
Figure 8.18: Residuals from the fitted ARIMA(0,1,3)(0,1,1)<span class="math inline">\(_4\)</span> model for the European retail trade index data.
</p>
</div>
<p>Both the ACF and PACF show significant spikes at lag 2, and almost significant spikes at lag 3, indicating that some additional non-seasonal terms need to be included in the model. The AICc of the ARIMA(0,1,2)(0,1,1)<span class="math inline">\(_4\)</span> model is 74.36, while that for the ARIMA(0,1,3)(0,1,1)<span class="math inline">\(_4\)</span> model is 68.53. We tried other models with AR terms as well, but none that gave a smaller AICc value. Consequently, we choose the ARIMA(0,1,3)(0,1,1)<span class="math inline">\(_4\)</span> model. Its residuals are plotted in Figure <a href="sec-seasonal-arima.html#fig:euretail5">8.19</a>. All the spikes are now within the significance limits, so the residuals appear to be white noise. The Ljung-Box test also shows that the residuals have no remaining autocorrelations.</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" data-line-number="1">fit3 &lt;-<span class="st"> </span><span class="kw">Arima</span>(euretail, <span class="dt">order=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>), <span class="dt">seasonal=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb152-2" data-line-number="2"><span class="kw">checkresiduals</span>(fit3)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:euretail5"></span>
<img src="fpp_files/figure-html/euretail5-1.png" alt="Residuals from the fitted ARIMA(0,1,3)(0,1,1)$_4$ model for the European retail trade index data." width="90%" />
<p class="caption">
Figure 8.19: Residuals from the fitted ARIMA(0,1,3)(0,1,1)<span class="math inline">\(_4\)</span> model for the European retail trade index data.
</p>
</div>
<pre><code>#&gt; 
#&gt;  Ljung-Box test
#&gt; 
#&gt; data:  Residuals from ARIMA(0,1,3)(0,1,1)[4]
#&gt; Q* = 0.5, df = 4, p-value = 1
#&gt; 
#&gt; Model df: 4.   Total lags used: 8</code></pre>
<p>Thus, we now have a seasonal ARIMA model that passes the required checks and is ready for forecasting. Forecasts from the model for the next three years are shown in Figure <a href="sec-seasonal-arima.html#fig:euretail6">8.20</a>. The forecasts follow the recent trend in the data, because of the double differencing. The large and rapidly increasing prediction intervals show that the retail trade index could start increasing or decreasing at any time — while the point forecasts trend downwards, the prediction intervals allow for the data to trend upwards during the forecast period.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" data-line-number="1">fit3 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h=</span><span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span>autoplot</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:euretail6"></span>
<img src="fpp_files/figure-html/euretail6-1.png" alt="Forecasts of the European retail trade index data using the ARIMA(0,1,3)(0,1,1)$_4$ model. 80% and 95% prediction intervals are shown." width="90%" />
<p class="caption">
Figure 8.20: Forecasts of the European retail trade index data using the ARIMA(0,1,3)(0,1,1)<span class="math inline">\(_4\)</span> model. 80% and 95% prediction intervals are shown.
</p>
</div>
<p>We could have used <code>auto.arima()</code> to do most of this work for us. It would have given the following result.</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" data-line-number="1"><span class="kw">auto.arima</span>(euretail)</a>
<a class="sourceLine" id="cb155-2" data-line-number="2"><span class="co">#&gt; Series: euretail </span></a>
<a class="sourceLine" id="cb155-3" data-line-number="3"><span class="co">#&gt; ARIMA(0,1,3)(0,1,1)[4] </span></a>
<a class="sourceLine" id="cb155-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb155-5" data-line-number="5"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb155-6" data-line-number="6"><span class="co">#&gt;         ma1    ma2    ma3    sma1</span></a>
<a class="sourceLine" id="cb155-7" data-line-number="7"><span class="co">#&gt;       0.263  0.369  0.420  -0.664</span></a>
<a class="sourceLine" id="cb155-8" data-line-number="8"><span class="co">#&gt; s.e.  0.124  0.126  0.129   0.155</span></a>
<a class="sourceLine" id="cb155-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb155-10" data-line-number="10"><span class="co">#&gt; sigma^2 estimated as 0.156:  log likelihood=-28.6</span></a>
<a class="sourceLine" id="cb155-11" data-line-number="11"><span class="co">#&gt; AIC=67.3   AICc=68.4   BIC=77.7</span></a></code></pre></div>
<p>Notice that it has selected a different model (with a larger AICc value). <code>auto.arima()</code> takes some short-cuts in order to speed up the computation, and will not always give the best model. The short-cuts can be turned off, and then it will sometimes return a different model.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" data-line-number="1"><span class="kw">auto.arima</span>(euretail, <span class="dt">stepwise=</span><span class="ot">FALSE</span>, <span class="dt">approximation=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb156-2" data-line-number="2"><span class="co">#&gt; Series: euretail </span></a>
<a class="sourceLine" id="cb156-3" data-line-number="3"><span class="co">#&gt; ARIMA(0,1,3)(0,1,1)[4] </span></a>
<a class="sourceLine" id="cb156-4" data-line-number="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb156-5" data-line-number="5"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb156-6" data-line-number="6"><span class="co">#&gt;         ma1    ma2    ma3    sma1</span></a>
<a class="sourceLine" id="cb156-7" data-line-number="7"><span class="co">#&gt;       0.263  0.369  0.420  -0.664</span></a>
<a class="sourceLine" id="cb156-8" data-line-number="8"><span class="co">#&gt; s.e.  0.124  0.126  0.129   0.155</span></a>
<a class="sourceLine" id="cb156-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb156-10" data-line-number="10"><span class="co">#&gt; sigma^2 estimated as 0.156:  log likelihood=-28.6</span></a>
<a class="sourceLine" id="cb156-11" data-line-number="11"><span class="co">#&gt; AIC=67.3   AICc=68.4   BIC=77.7</span></a></code></pre></div>
<p>This time it returned the same model we had identified.</p>
</div>
<div id="example-cortecosteroid-drug-sales-in-australia" class="section level3 unnumbered">
<h3>Example: Cortecosteroid drug sales in Australia</h3>
<p>Our second example is more difficult. We will try to forecast monthly cortecosteroid drug sales in Australia. These are known as H02 drugs under the Anatomical Therapeutical Chemical classification scheme.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" data-line-number="1">lh02 &lt;-<span class="st"> </span><span class="kw">log</span>(h02)</a>
<a class="sourceLine" id="cb157-2" data-line-number="2"><span class="kw">cbind</span>(<span class="st">&quot;H02 sales (million scripts)&quot;</span> =<span class="st"> </span>h02,</a>
<a class="sourceLine" id="cb157-3" data-line-number="3">      <span class="st">&quot;Log H02 sales&quot;</span>=lh02) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb157-4" data-line-number="4"><span class="st">  </span><span class="kw">autoplot</span>(<span class="dt">facets=</span><span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:h02"></span>
<img src="fpp_files/figure-html/h02-1.png" alt="Cortecosteroid drug sales in Australia (in millions of scripts per month). Logged data shown in bottom panel." width="90%" />
<p class="caption">
Figure 8.21: Cortecosteroid drug sales in Australia (in millions of scripts per month). Logged data shown in bottom panel.
</p>
</div>
<p>Data from July 1991 to June 2008 are plotted in Figure <a href="sec-seasonal-arima.html#fig:h02">8.21</a>. There is a small increase in the variance with the level, so we take logarithms to stabilize the variance.</p>
<p>The data are strongly seasonal and obviously non-stationary, so seasonal differencing will be used. The seasonally differenced data are shown in Figure <a href="sec-seasonal-arima.html#fig:h02b">8.22</a>. It is not clear at this point whether we should do another difference or not. We decide not to, but the choice is not obvious.</p>
<p>The last few observations appear to be different (more variable) from the earlier data. This may be due to the fact that data are sometimes revised when earlier sales are reported late.</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" data-line-number="1">lh02 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">diff</span>(<span class="dt">lag=</span><span class="dv">12</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb158-2" data-line-number="2"><span class="st">  </span><span class="kw">ggtsdisplay</span>(<span class="dt">xlab=</span><span class="st">&quot;Year&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Seasonally differenced H02 scripts&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:h02b"></span>
<img src="fpp_files/figure-html/h02b-1.png" alt="Seasonally differenced cortecosteroid drug sales in Australia (in millions of scripts per month)." width="90%" />
<p class="caption">
Figure 8.22: Seasonally differenced cortecosteroid drug sales in Australia (in millions of scripts per month).
</p>
</div>
<p>In the plots of the seasonally differenced data, there are spikes in the PACF at lags 12 and 24, but nothing at seasonal lags in the ACF. This may be suggestive of a seasonal AR(2) term. In the non-seasonal lags, there are three significant spikes in the PACF, suggesting a possible AR(3) term. The pattern in the ACF is not indicative of any simple model.</p>
<p>Consequently, this initial analysis suggests that a possible model for these data is an ARIMA(3,0,0)(2,1,0)<span class="math inline">\(_{12}\)</span>. We fit this model, along with some variations on it, and compute the AICc values shown in the following table.</p>
<table>
<thead>
<tr class="header">
<th align="center">Model</th>
<th align="center">AICc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-485</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,1)(1,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-484</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-484</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,1)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-476</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,0)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-475</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,2)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-475</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(1,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">-463</td>
</tr>
</tbody>
</table>
<p>Of these models, the best is the ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span> model (i.e., it has the smallest AICc value).</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" data-line-number="1">(fit &lt;-<span class="st"> </span><span class="kw">Arima</span>(h02, <span class="dt">order=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">seasonal=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">lambda=</span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb159-2" data-line-number="2"><span class="co">#&gt; Series: h02 </span></a>
<a class="sourceLine" id="cb159-3" data-line-number="3"><span class="co">#&gt; ARIMA(3,0,1)(0,1,2)[12] </span></a>
<a class="sourceLine" id="cb159-4" data-line-number="4"><span class="co">#&gt; Box Cox transformation: lambda= 0 </span></a>
<a class="sourceLine" id="cb159-5" data-line-number="5"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb159-6" data-line-number="6"><span class="co">#&gt; Coefficients:</span></a>
<a class="sourceLine" id="cb159-7" data-line-number="7"><span class="co">#&gt;          ar1    ar2    ar3    ma1    sma1    sma2</span></a>
<a class="sourceLine" id="cb159-8" data-line-number="8"><span class="co">#&gt;       -0.160  0.548  0.568  0.383  -0.522  -0.177</span></a>
<a class="sourceLine" id="cb159-9" data-line-number="9"><span class="co">#&gt; s.e.   0.164  0.088  0.094  0.190   0.086   0.087</span></a>
<a class="sourceLine" id="cb159-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb159-11" data-line-number="11"><span class="co">#&gt; sigma^2 estimated as 0.00428:  log likelihood=250</span></a>
<a class="sourceLine" id="cb159-12" data-line-number="12"><span class="co">#&gt; AIC=-486   AICc=-485   BIC=-463</span></a></code></pre></div>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" data-line-number="1"><span class="kw">checkresiduals</span>(fit, <span class="dt">lag=</span><span class="dv">36</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:h02res"></span>
<img src="fpp_files/figure-html/h02res-1.png" alt="Residuals from the ARIMA(3,0,1)(0,1,2)$_{12}$ model applied to the H02 monthly script sales data." width="90%" />
<p class="caption">
Figure 8.23: Residuals from the ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span> model applied to the H02 monthly script sales data.
</p>
</div>
<pre><code>#&gt; 
#&gt;  Ljung-Box test
#&gt; 
#&gt; data:  Residuals from ARIMA(3,0,1)(0,1,2)[12]
#&gt; Q* = 51, df = 30, p-value = 0.01
#&gt; 
#&gt; Model df: 6.   Total lags used: 36</code></pre>
<p>The residuals from this model are shown in Figure <a href="sec-seasonal-arima.html#fig:h02res">8.23</a>. There are a few significant spikes in the ACF, and the model fails the Ljung-Box test. The model can still be used for forecasting, but the prediction intervals may not be accurate due to the correlated residuals.</p>
<p>Next we will try using the automatic ARIMA algorithm. Running <code>auto.arima()</code> with all arguments left at their default values led to an ARIMA(2,1,3)(0,1,1)<span class="math inline">\(_{12}\)</span> model. However, the model still fails the Ljung-Box test. Sometimes it is just not possible to find a model that passes all of the tests.</p>
<div id="test-set-evaluation" class="section level4 unnumbered">
<h4>Test set evaluation:</h4>
<p>We will compare some of the models fitted so far using a test set consisting of the last two years of data. Thus, we fit the models using data from July 1991 to June 2006, and forecast the script sales for July 2006 – June 2008. The results are summarised in the following table.</p>
<table>
<thead>
<tr class="header">
<th align="center">Model</th>
<th align="center">RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0622</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,1)(1,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0630</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(2,1,4)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0632</td>
</tr>
<tr class="even">
<td align="center">ARIMA(2,1,3)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0634</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,3)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0639</td>
</tr>
<tr class="even">
<td align="center">ARIMA(2,1,5)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0640</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,1)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0644</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,2)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0644</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,2)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0645</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,1)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0646</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(4,0,2)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0648</td>
</tr>
<tr class="even">
<td align="center">ARIMA(4,0,3)(0,1,1)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0648</td>
</tr>
<tr class="odd">
<td align="center">ARIMA(3,0,0)(2,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0661</td>
</tr>
<tr class="even">
<td align="center">ARIMA(3,0,1)(1,1,0)<span class="math inline">\(_{12}\)</span></td>
<td align="center">0.0679</td>
</tr>
</tbody>
</table>
<p>The models chosen manually and with <code>auto.arima</code> are both in the top four models based on their RMSE values.</p>
<p>When models are compared using AICc values, it is important that all models have the same orders of differencing. However, when comparing models using a test set, it does not matter how the forecasts were produced — the comparisons are always valid. Consequently, in the table above, we can include some models with only seasonal differencing and some models with both first and seasonal differencing, while in the earlier table containing AICc values, we only compared models with seasonal differencing but no first differencing.</p>
<p>None of the models considered here pass all of the residual tests. In practice, we would normally use the best model we could find, even if it did not pass all of the tests.</p>
<p>Forecasts from the ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span> model (which has the lowest RMSE value on the test set, and the best AICc value amongst models with only seasonal differencing) are shown in Figure <a href="sec-seasonal-arima.html#fig:h02f">8.24</a>.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" data-line-number="1">h02 <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb162-2" data-line-number="2"><span class="st">  </span><span class="kw">Arima</span>(<span class="dt">order=</span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">seasonal=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">lambda=</span><span class="dv">0</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb162-3" data-line-number="3"><span class="st">  </span><span class="kw">forecast</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb162-4" data-line-number="4"><span class="st">  </span><span class="kw">autoplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb162-5" data-line-number="5"><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;H02 sales (million scripts)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Year&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:h02f"></span>
<img src="fpp_files/figure-html/h02f-1.png" alt="Forecasts from the ARIMA(3,0,1)(0,1,2)$_{12}$ model applied to the H02 monthly script sales data." width="90%" />
<p class="caption">
Figure 8.24: Forecasts from the ARIMA(3,0,1)(0,1,2)<span class="math inline">\(_{12}\)</span> model applied to the H02 monthly script sales data.
</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="forecasting.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="arima-vs-ets.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/robjhyndman/fpp2/edit/master/08-arima.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
