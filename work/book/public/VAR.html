<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11.3 Vector autoregressions | Forecasting: Principles and Practice</title>
  <meta name="description" content="2nd edition" />
  <meta name="generator" content="bookdown 0.12 and GitBook 2.6.7" />

  <meta property="og:title" content="11.3 Vector autoregressions | Forecasting: Principles and Practice" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://Otexts.org/fpp2/" />
  <meta property="og:image" content="http://Otexts.org/fpp2/fppcover.jpg" />
  <meta property="og:description" content="2nd edition" />
  <meta name="github-repo" content="robjhyndman/fpp2" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11.3 Vector autoregressions | Forecasting: Principles and Practice" />
  <meta name="twitter:site" content="@robjhyndman" />
  <meta name="twitter:description" content="2nd edition" />
  <meta name="twitter:image" content="http://Otexts.org/fpp2/fppcover.jpg" />

<meta name="author" content="Rob J Hyndman" />
<meta name="author" content="George Athanasopoulos" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="forecasting-counts.html">
<link rel="next" href="sec-9-3-nnet.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { 
    equationNumbers: { autoNumber: "AMS" } ,
    Macros: {
      bm: ["\\boldsymbol{#1}",1],
      y:    ["y_{\\text{#1},#2}",2],
      yhat: ["\\hat{y}_{\\text{#1},#2}",2],
      ytilde: ["\\tilde{y}_{\\text{#1},#2}",2],
      Shat: ["\\hat{S}_{\\text{#1},#2}^{(#3)}",3]
    }
  }
});
</script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Forecasting: Principles and Practice</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="ch-intro.html"><a href="ch-intro.html"><i class="fa fa-check"></i><b>1</b> Getting started</a><ul>
<li class="chapter" data-level="1.1" data-path="what-can-be-forecast.html"><a href="what-can-be-forecast.html"><i class="fa fa-check"></i><b>1.1</b> What can be forecast?</a></li>
<li class="chapter" data-level="1.2" data-path="sec-1-2-ForPlanGoals.html"><a href="sec-1-2-ForPlanGoals.html"><i class="fa fa-check"></i><b>1.2</b> Forecasting, planning and goals</a></li>
<li class="chapter" data-level="1.3" data-path="determining-what-to-forecast.html"><a href="determining-what-to-forecast.html"><i class="fa fa-check"></i><b>1.3</b> Determining what to forecast</a></li>
<li class="chapter" data-level="1.4" data-path="Intro-DataAndMethods.html"><a href="Intro-DataAndMethods.html"><i class="fa fa-check"></i><b>1.4</b> Forecasting data and methods</a></li>
<li class="chapter" data-level="1.5" data-path="case-studies.html"><a href="case-studies.html"><i class="fa fa-check"></i><b>1.5</b> Some case studies</a></li>
<li class="chapter" data-level="1.6" data-path="the-basic-steps-in-a-forecasting-task.html"><a href="the-basic-steps-in-a-forecasting-task.html"><i class="fa fa-check"></i><b>1.6</b> The basic steps in a forecasting task</a></li>
<li class="chapter" data-level="1.7" data-path="sec-perspective.html"><a href="sec-perspective.html"><i class="fa fa-check"></i><b>1.7</b> The statistical forecasting perspective</a></li>
<li class="chapter" data-level="1.8" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>1.8</b> Exercises</a></li>
<li class="chapter" data-level="1.9" data-path="further-reading.html"><a href="further-reading.html"><i class="fa fa-check"></i><b>1.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-graphics.html"><a href="ch-graphics.html"><i class="fa fa-check"></i><b>2</b> Time series graphics</a><ul>
<li class="chapter" data-level="2.1" data-path="ts-objects.html"><a href="ts-objects.html"><i class="fa fa-check"></i><b>2.1</b> <code>ts</code> objects</a></li>
<li class="chapter" data-level="2.2" data-path="time-plots.html"><a href="time-plots.html"><i class="fa fa-check"></i><b>2.2</b> Time plots</a></li>
<li class="chapter" data-level="2.3" data-path="tspatterns.html"><a href="tspatterns.html"><i class="fa fa-check"></i><b>2.3</b> Time series patterns</a></li>
<li class="chapter" data-level="2.4" data-path="seasonal-plots.html"><a href="seasonal-plots.html"><i class="fa fa-check"></i><b>2.4</b> Seasonal plots</a></li>
<li class="chapter" data-level="2.5" data-path="seasonal-subseries-plots.html"><a href="seasonal-subseries-plots.html"><i class="fa fa-check"></i><b>2.5</b> Seasonal subseries plots</a></li>
<li class="chapter" data-level="2.6" data-path="scatterplots.html"><a href="scatterplots.html"><i class="fa fa-check"></i><b>2.6</b> Scatterplots</a></li>
<li class="chapter" data-level="2.7" data-path="lag-plots.html"><a href="lag-plots.html"><i class="fa fa-check"></i><b>2.7</b> Lag plots</a></li>
<li class="chapter" data-level="2.8" data-path="autocorrelation.html"><a href="autocorrelation.html"><i class="fa fa-check"></i><b>2.8</b> Autocorrelation</a></li>
<li class="chapter" data-level="2.9" data-path="wn.html"><a href="wn.html"><i class="fa fa-check"></i><b>2.9</b> White noise</a></li>
<li class="chapter" data-level="2.10" data-path="ex-graphics.html"><a href="ex-graphics.html"><i class="fa fa-check"></i><b>2.10</b> Exercises</a></li>
<li class="chapter" data-level="2.11" data-path="further-reading-1.html"><a href="further-reading-1.html"><i class="fa fa-check"></i><b>2.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-toolbox.html"><a href="ch-toolbox.html"><i class="fa fa-check"></i><b>3</b> The forecaster’s toolbox</a><ul>
<li class="chapter" data-level="3.1" data-path="sec-2-methods.html"><a href="sec-2-methods.html"><i class="fa fa-check"></i><b>3.1</b> Some simple forecasting methods</a></li>
<li class="chapter" data-level="3.2" data-path="sec-transformations.html"><a href="sec-transformations.html"><i class="fa fa-check"></i><b>3.2</b> Transformations and adjustments</a></li>
<li class="chapter" data-level="3.3" data-path="residuals.html"><a href="residuals.html"><i class="fa fa-check"></i><b>3.3</b> Residual diagnostics</a></li>
<li class="chapter" data-level="3.4" data-path="accuracy.html"><a href="accuracy.html"><i class="fa fa-check"></i><b>3.4</b> Evaluating forecast accuracy</a></li>
<li class="chapter" data-level="3.5" data-path="sec-PI.html"><a href="sec-PI.html"><i class="fa fa-check"></i><b>3.5</b> Prediction intervals</a></li>
<li class="chapter" data-level="3.6" data-path="the-forecast-package-in-r.html"><a href="the-forecast-package-in-r.html"><i class="fa fa-check"></i><b>3.6</b> The forecast package in R</a></li>
<li class="chapter" data-level="3.7" data-path="ex-toolbox.html"><a href="ex-toolbox.html"><i class="fa fa-check"></i><b>3.7</b> Exercises</a></li>
<li class="chapter" data-level="3.8" data-path="further-reading-2.html"><a href="further-reading-2.html"><i class="fa fa-check"></i><b>3.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-judgmental.html"><a href="ch-judgmental.html"><i class="fa fa-check"></i><b>4</b> Judgmental forecasts</a><ul>
<li class="chapter" data-level="4.1" data-path="sec-3-limitations.html"><a href="sec-3-limitations.html"><i class="fa fa-check"></i><b>4.1</b> Beware of limitations</a></li>
<li class="chapter" data-level="4.2" data-path="sec-3-Key-principles.html"><a href="sec-3-Key-principles.html"><i class="fa fa-check"></i><b>4.2</b> Key principles</a></li>
<li class="chapter" data-level="4.3" data-path="sec-3-Delphi.html"><a href="sec-3-Delphi.html"><i class="fa fa-check"></i><b>4.3</b> The Delphi method</a></li>
<li class="chapter" data-level="4.4" data-path="sec-3-Analogy.html"><a href="sec-3-Analogy.html"><i class="fa fa-check"></i><b>4.4</b> Forecasting by analogy</a></li>
<li class="chapter" data-level="4.5" data-path="sec-3-Scenario.html"><a href="sec-3-Scenario.html"><i class="fa fa-check"></i><b>4.5</b> Scenario Forecasting</a></li>
<li class="chapter" data-level="4.6" data-path="sec-3-NPF.html"><a href="sec-3-NPF.html"><i class="fa fa-check"></i><b>4.6</b> New product forecasting</a></li>
<li class="chapter" data-level="4.7" data-path="sec-3-Adjustments.html"><a href="sec-3-Adjustments.html"><i class="fa fa-check"></i><b>4.7</b> Judgmental adjustments</a></li>
<li class="chapter" data-level="4.8" data-path="further-reading-3.html"><a href="further-reading-3.html"><i class="fa fa-check"></i><b>4.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-regression.html"><a href="ch-regression.html"><i class="fa fa-check"></i><b>5</b> Linear regression models</a><ul>
<li class="chapter" data-level="5.1" data-path="Regr-Intro.html"><a href="Regr-Intro.html"><i class="fa fa-check"></i><b>5.1</b> The linear model</a></li>
<li class="chapter" data-level="5.2" data-path="Regr-LSprinciple.html"><a href="Regr-LSprinciple.html"><i class="fa fa-check"></i><b>5.2</b> Least squares estimation</a></li>
<li class="chapter" data-level="5.3" data-path="Regr-UsefulPredictors.html"><a href="Regr-UsefulPredictors.html"><i class="fa fa-check"></i><b>5.3</b> Some useful predictors</a></li>
<li class="chapter" data-level="5.4" data-path="Regr-EvaluatingSLR.html"><a href="Regr-EvaluatingSLR.html"><i class="fa fa-check"></i><b>5.4</b> Evaluating the regression model</a></li>
<li class="chapter" data-level="5.5" data-path="Regr-SelectingPredictors.html"><a href="Regr-SelectingPredictors.html"><i class="fa fa-check"></i><b>5.5</b> Selecting predictors</a></li>
<li class="chapter" data-level="5.6" data-path="Regr-ForeWithRegr.html"><a href="Regr-ForeWithRegr.html"><i class="fa fa-check"></i><b>5.6</b> Forecasting with regression</a></li>
<li class="chapter" data-level="5.7" data-path="Regr-MatrixEquations.html"><a href="Regr-MatrixEquations.html"><i class="fa fa-check"></i><b>5.7</b> Matrix formulation</a></li>
<li class="chapter" data-level="5.8" data-path="Regr-NonLinear.html"><a href="Regr-NonLinear.html"><i class="fa fa-check"></i><b>5.8</b> Nonlinear regression</a></li>
<li class="chapter" data-level="5.9" data-path="Regr-MultiCol.html"><a href="Regr-MultiCol.html"><i class="fa fa-check"></i><b>5.9</b> Correlation, causation and forecasting</a></li>
<li class="chapter" data-level="5.10" data-path="Regr-exercises.html"><a href="Regr-exercises.html"><i class="fa fa-check"></i><b>5.10</b> Exercises</a></li>
<li class="chapter" data-level="5.11" data-path="further-reading-4.html"><a href="further-reading-4.html"><i class="fa fa-check"></i><b>5.11</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-decomposition.html"><a href="ch-decomposition.html"><i class="fa fa-check"></i><b>6</b> Time series decomposition</a><ul>
<li class="chapter" data-level="6.1" data-path="sec-6-1-TSpatterns.html"><a href="sec-6-1-TSpatterns.html"><i class="fa fa-check"></i><b>6.1</b> Time series components</a></li>
<li class="chapter" data-level="6.2" data-path="moving-averages.html"><a href="moving-averages.html"><i class="fa fa-check"></i><b>6.2</b> Moving averages</a></li>
<li class="chapter" data-level="6.3" data-path="classical-decomposition.html"><a href="classical-decomposition.html"><i class="fa fa-check"></i><b>6.3</b> Classical decomposition</a></li>
<li class="chapter" data-level="6.4" data-path="x11-decomposition.html"><a href="x11-decomposition.html"><i class="fa fa-check"></i><b>6.4</b> X11 decomposition</a></li>
<li class="chapter" data-level="6.5" data-path="seats-decomposition.html"><a href="seats-decomposition.html"><i class="fa fa-check"></i><b>6.5</b> SEATS decomposition</a></li>
<li class="chapter" data-level="6.6" data-path="sec-6-stl.html"><a href="sec-6-stl.html"><i class="fa fa-check"></i><b>6.6</b> STL decomposition</a></li>
<li class="chapter" data-level="6.7" data-path="forecasting-with-decomposition.html"><a href="forecasting-with-decomposition.html"><i class="fa fa-check"></i><b>6.7</b> Forecasting with decomposition</a></li>
<li class="chapter" data-level="6.8" data-path="exercises-1.html"><a href="exercises-1.html"><i class="fa fa-check"></i><b>6.8</b> Exercises</a></li>
<li class="chapter" data-level="6.9" data-path="further-reading-5.html"><a href="further-reading-5.html"><i class="fa fa-check"></i><b>6.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-expsmooth.html"><a href="ch-expsmooth.html"><i class="fa fa-check"></i><b>7</b> Exponential smoothing</a><ul>
<li class="chapter" data-level="7.1" data-path="sec-7-1-SES.html"><a href="sec-7-1-SES.html"><i class="fa fa-check"></i><b>7.1</b> Simple exponential smoothing</a></li>
<li class="chapter" data-level="7.2" data-path="sec-7-trendmethods.html"><a href="sec-7-trendmethods.html"><i class="fa fa-check"></i><b>7.2</b> Trend methods</a></li>
<li class="chapter" data-level="7.3" data-path="sec-7-Taxonomy.html"><a href="sec-7-Taxonomy.html"><i class="fa fa-check"></i><b>7.3</b> Holt-Winters’ seasonal method</a></li>
<li class="chapter" data-level="7.4" data-path="sec-7-6-Taxonomy.html"><a href="sec-7-6-Taxonomy.html"><i class="fa fa-check"></i><b>7.4</b> A taxonomy of exponential smoothing methods</a></li>
<li class="chapter" data-level="7.5" data-path="sec-7-ETS.html"><a href="sec-7-ETS.html"><i class="fa fa-check"></i><b>7.5</b> Innovations state space models for exponential smoothing</a></li>
<li class="chapter" data-level="7.6" data-path="estimation-and-model-selection.html"><a href="estimation-and-model-selection.html"><i class="fa fa-check"></i><b>7.6</b> Estimation and model selection</a></li>
<li class="chapter" data-level="7.7" data-path="forecasting-with-ets-models.html"><a href="forecasting-with-ets-models.html"><i class="fa fa-check"></i><b>7.7</b> Forecasting with ETS models</a></li>
<li class="chapter" data-level="7.8" data-path="exercises-2.html"><a href="exercises-2.html"><i class="fa fa-check"></i><b>7.8</b> Exercises</a></li>
<li class="chapter" data-level="7.9" data-path="further-reading-6.html"><a href="further-reading-6.html"><i class="fa fa-check"></i><b>7.9</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="ch-arima.html"><a href="ch-arima.html"><i class="fa fa-check"></i><b>8</b> ARIMA models</a><ul>
<li class="chapter" data-level="8.1" data-path="stationarity-and-differencing.html"><a href="stationarity-and-differencing.html"><i class="fa fa-check"></i><b>8.1</b> Stationarity and differencing</a></li>
<li class="chapter" data-level="8.2" data-path="backshift-notation.html"><a href="backshift-notation.html"><i class="fa fa-check"></i><b>8.2</b> Backshift notation</a></li>
<li class="chapter" data-level="8.3" data-path="autoregressive-models.html"><a href="autoregressive-models.html"><i class="fa fa-check"></i><b>8.3</b> Autoregressive models</a></li>
<li class="chapter" data-level="8.4" data-path="sec-mamodels.html"><a href="sec-mamodels.html"><i class="fa fa-check"></i><b>8.4</b> Moving average models</a></li>
<li class="chapter" data-level="8.5" data-path="sec-nonseasonalarima.html"><a href="sec-nonseasonalarima.html"><i class="fa fa-check"></i><b>8.5</b> Non-seasonal ARIMA models</a></li>
<li class="chapter" data-level="8.6" data-path="estimation-and-order-selection.html"><a href="estimation-and-order-selection.html"><i class="fa fa-check"></i><b>8.6</b> Estimation and order selection</a></li>
<li class="chapter" data-level="8.7" data-path="arima-modelling-in-r.html"><a href="arima-modelling-in-r.html"><i class="fa fa-check"></i><b>8.7</b> ARIMA modelling in R</a></li>
<li class="chapter" data-level="8.8" data-path="forecasting.html"><a href="forecasting.html"><i class="fa fa-check"></i><b>8.8</b> Forecasting</a></li>
<li class="chapter" data-level="8.9" data-path="sec-seasonal-arima.html"><a href="sec-seasonal-arima.html"><i class="fa fa-check"></i><b>8.9</b> Seasonal ARIMA models</a></li>
<li class="chapter" data-level="8.10" data-path="arima-vs-ets.html"><a href="arima-vs-ets.html"><i class="fa fa-check"></i><b>8.10</b> ARIMA vs ETS</a></li>
<li class="chapter" data-level="8.11" data-path="exercises-3.html"><a href="exercises-3.html"><i class="fa fa-check"></i><b>8.11</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-dynamic.html"><a href="ch-dynamic.html"><i class="fa fa-check"></i><b>9</b> Dynamic regression models</a><ul>
<li class="chapter" data-level="9.1" data-path="estimation.html"><a href="estimation.html"><i class="fa fa-check"></i><b>9.1</b> Estimation</a></li>
<li class="chapter" data-level="9.2" data-path="regression-with-arima-errors-in-r.html"><a href="regression-with-arima-errors-in-r.html"><i class="fa fa-check"></i><b>9.2</b> Regression with ARIMA errors in R</a></li>
<li class="chapter" data-level="9.3" data-path="forecasting-1.html"><a href="forecasting-1.html"><i class="fa fa-check"></i><b>9.3</b> Forecasting</a></li>
<li class="chapter" data-level="9.4" data-path="stochastic-and-deterministic-trends.html"><a href="stochastic-and-deterministic-trends.html"><i class="fa fa-check"></i><b>9.4</b> Stochastic and deterministic trends</a></li>
<li class="chapter" data-level="9.5" data-path="sec-dhr.html"><a href="sec-dhr.html"><i class="fa fa-check"></i><b>9.5</b> Dynamic harmonic regression</a></li>
<li class="chapter" data-level="9.6" data-path="lagged-predictors.html"><a href="lagged-predictors.html"><i class="fa fa-check"></i><b>9.6</b> Lagged predictors</a></li>
<li class="chapter" data-level="9.7" data-path="exercises-4.html"><a href="exercises-4.html"><i class="fa fa-check"></i><b>9.7</b> Exercises</a></li>
<li class="chapter" data-level="9.8" data-path="further-reading-7.html"><a href="further-reading-7.html"><i class="fa fa-check"></i><b>9.8</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="ch-hierarchical.html"><a href="ch-hierarchical.html"><i class="fa fa-check"></i><b>10</b> Forecasting hierarchical or grouped time series</a><ul>
<li class="chapter" data-level="10.1" data-path="Hier-hierarchical-ts.html"><a href="Hier-hierarchical-ts.html"><i class="fa fa-check"></i><b>10.1</b> Hierarchical time series</a></li>
<li class="chapter" data-level="10.2" data-path="Hier-grouped-ts.html"><a href="Hier-grouped-ts.html"><i class="fa fa-check"></i><b>10.2</b> Grouped time series</a></li>
<li class="chapter" data-level="10.3" data-path="Hier-base-coherent-forecasts.html"><a href="Hier-base-coherent-forecasts.html"><i class="fa fa-check"></i><b>10.3</b> Base and coherent forecasts</a></li>
<li class="chapter" data-level="10.4" data-path="Hier-bu.html"><a href="Hier-bu.html"><i class="fa fa-check"></i><b>10.4</b> The bottom-up approach</a></li>
<li class="chapter" data-level="10.5" data-path="Hier-td.html"><a href="Hier-td.html"><i class="fa fa-check"></i><b>10.5</b> Top-down approaches</a></li>
<li class="chapter" data-level="10.6" data-path="Hier-mo.html"><a href="Hier-mo.html"><i class="fa fa-check"></i><b>10.6</b> Middle-out approach</a></li>
<li class="chapter" data-level="10.7" data-path="Hier-projection.html"><a href="Hier-projection.html"><i class="fa fa-check"></i><b>10.7</b> The projection matrix</a></li>
<li class="chapter" data-level="10.8" data-path="Hier-reconciliation.html"><a href="Hier-reconciliation.html"><i class="fa fa-check"></i><b>10.8</b> The optimal reconciliation approach</a></li>
<li class="chapter" data-level="10.9" data-path="ex-hierarchical.html"><a href="ex-hierarchical.html"><i class="fa fa-check"></i><b>10.9</b> Exercises</a></li>
<li class="chapter" data-level="10.10" data-path="further-reading-8.html"><a href="further-reading-8.html"><i class="fa fa-check"></i><b>10.10</b> Further reading</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ch-advanced.html"><a href="ch-advanced.html"><i class="fa fa-check"></i><b>11</b> Advanced forecasting methods</a><ul>
<li class="chapter" data-level="11.1" data-path="sec-complexseasonality.html"><a href="sec-complexseasonality.html"><i class="fa fa-check"></i><b>11.1</b> Complex seasonality</a></li>
<li class="chapter" data-level="11.2" data-path="forecasting-counts.html"><a href="forecasting-counts.html"><i class="fa fa-check"></i><b>11.2</b> Forecasting counts</a></li>
<li class="chapter" data-level="11.3" data-path="VAR.html"><a href="VAR.html"><i class="fa fa-check"></i><b>11.3</b> Vector autoregressions</a></li>
<li class="chapter" data-level="11.4" data-path="sec-9-3-nnet.html"><a href="sec-9-3-nnet.html"><i class="fa fa-check"></i><b>11.4</b> Neural network models</a></li>
<li class="chapter" data-level="11.5" data-path="sec-ex-11.html"><a href="sec-ex-11.html"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch-practical.html"><a href="ch-practical.html"><i class="fa fa-check"></i><b>12</b> Some practical forecasting issues</a><ul>
<li class="chapter" data-level="12.1" data-path="weekly.html"><a href="weekly.html"><i class="fa fa-check"></i><b>12.1</b> Weekly, daily and sub-daily data</a></li>
<li class="chapter" data-level="12.2" data-path="counts.html"><a href="counts.html"><i class="fa fa-check"></i><b>12.2</b> Time series of counts</a></li>
<li class="chapter" data-level="12.3" data-path="limits.html"><a href="limits.html"><i class="fa fa-check"></i><b>12.3</b> Ensuring forecasts stay within limits</a></li>
<li class="chapter" data-level="12.4" data-path="combinations.html"><a href="combinations.html"><i class="fa fa-check"></i><b>12.4</b> Forecast combinations</a></li>
<li class="chapter" data-level="12.5" data-path="aggregates.html"><a href="aggregates.html"><i class="fa fa-check"></i><b>12.5</b> Prediction intervals for aggregates</a></li>
<li class="chapter" data-level="12.6" data-path="backcasting.html"><a href="backcasting.html"><i class="fa fa-check"></i><b>12.6</b> Backcasting</a></li>
<li class="chapter" data-level="12.7" data-path="short-ts.html"><a href="short-ts.html"><i class="fa fa-check"></i><b>12.7</b> Forecasting very short time series</a></li>
<li class="chapter" data-level="12.8" data-path="long-ts.html"><a href="long-ts.html"><i class="fa fa-check"></i><b>12.8</b> Forecasting very long time series</a></li>
<li class="chapter" data-level="12.9" data-path="oosos.html"><a href="oosos.html"><i class="fa fa-check"></i><b>12.9</b> One-step forecasts on test data</a></li>
<li class="chapter" data-level="12.10" data-path="isms.html"><a href="isms.html"><i class="fa fa-check"></i><b>12.10</b> Multi-step forecasts on training data</a></li>
<li class="chapter" data-level="12.11" data-path="missing-outliers.html"><a href="missing-outliers.html"><i class="fa fa-check"></i><b>12.11</b> Dealing with missing values and outliers</a></li>
<li class="chapter" data-level="12.12" data-path="bootstrap.html"><a href="bootstrap.html"><i class="fa fa-check"></i><b>12.12</b> Bootstrapping and bagging</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="using-r.html"><a href="using-r.html"><i class="fa fa-check"></i>Using R</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://OTexts.org" target="blank">Published by OTexts with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Forecasting: Principles and Practice</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="VAR" class="section level2">
<h2><span class="header-section-number">11.3</span> Vector autoregressions</h2>
<p>One limitation with the models we have considered so far is that they impose a unidirectional relationship — the forecast variable is influenced by the predictor variables, but not vice versa. However, there are many cases where the reverse should also be allowed for — where all variables affect each other. In Chapter 9, the changes in personal consumption expenditure (<span class="math inline">\(C_t\)</span>) were forecast based on the changes in personal disposable income (<span class="math inline">\(I_t\)</span>). However, in this case a bi-directional relationship may be more suitable: an increase in <span class="math inline">\(I_t\)</span> will lead to an increase in <span class="math inline">\(C_t\)</span> and vice versa.</p>
<p>An example of such a situation occurred in Australia during the Global Financial Crisis of 2008–2009. The Australian government issued stimulus packages that included cash payments in December 2008, just in time for Christmas spending. As a result, retailers reported strong sales and the economy was stimulated. Consequently, incomes increased.</p>
<p>Such feedback relationships are allowed for in the vector autoregressive (VAR) framework. In this framework, all variables are treated symmetrically. They are all modelled as if they influence each other equally. In more formal terminology, all variables are now treated as “endogenous”. To signify this we now change the notation and write all variables as <span class="math inline">\(y\)</span>s: <span class="math inline">\(y_{1,t}\)</span> denotes the <span class="math inline">\(t\)</span>th observation of variable <span class="math inline">\(y_1\)</span>, <span class="math inline">\(y_{2,t}\)</span> denotes the <span class="math inline">\(t\)</span>th observation of variable <span class="math inline">\(y_2\)</span>, and so on.</p>
<p>A VAR model is a generalisation of the univariate autoregressive model for forecasting a collection of variables; that is, a vector of time series.<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a> It comprises one equation per variable considered in the system. The right hand side of each equation includes a constant and lags of all the variables in the system. To keep it simple, we will consider a two variable VAR with one lag. We write a 2-dimensional VAR(1) as
<span class="math display" id="eq:var1b" id="eq:var1a">\[\begin{align}
\label{var1a}
  y_{1,t} &amp;= c_1+\phi _{11,1}y_{1,t-1}+\phi _{12,1}y_{2,t-1}+e_{1,t} \tag{11.1}\\
  y_{2,t} &amp;= c_2+\phi _{21,1}y_{1,t-1}+\phi _{22,1}y_{2,t-1}+e_{2,t} \tag{11.2}
\end{align}\]</span>
where <span class="math inline">\(e_{1,t}\)</span> and <span class="math inline">\(e_{2,t}\)</span> are white noise processes that may be contemporaneously correlated. Coefficient <span class="math inline">\(\phi_{ii,\ell}\)</span> captures the influence of the <span class="math inline">\(\ell\)</span>th lag of variable <span class="math inline">\(y_i\)</span> on itself, while coefficient <span class="math inline">\(\phi_{ij,\ell}\)</span> captures the influence of the <span class="math inline">\(\ell\)</span>th lag of variable <span class="math inline">\(y_j\)</span> on <span class="math inline">\(y_i\)</span>.</p>
<p>If the series modelled are stationary we forecast them by directly fitting a VAR to the data (known as a “VAR in levels”). If the series are non-stationary we take differences to make them stationary and then we fit a VAR model (known as a “VAR in differences”). In both cases, the models are estimated equation by equation using the principle of least squares. For each equation, the parameters are estimated by minimising the sum of squared <span class="math inline">\(e_{i,t}\)</span> values.</p>
<p>The other possibility which is beyond the scope of this book and therefore we do not explore here, is that series may be non-stationary but they are cointegrated, which means that there exists a linear combination of them that is stationary. In this case a VAR specification that includes an error correction mechanism (usually referred to as a vector error correction model) should be included and alternative estimation methods to least squares estimation should be used.<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a></p>
<p>Forecasts are generated from a VAR in a recursive manner. The VAR generates forecasts for <em>each</em> variable included in the system. To illustrate the process, assume that we have fitted the 2-dimensional VAR(1) described in equations <a href="VAR.html#eq:var1a">(11.1)</a>–<a href="VAR.html#eq:var1b">(11.2)</a>, for all observations up to time <span class="math inline">\(T\)</span>. Then the one-step-ahead forecasts are generated by
<span class="math display">\[\begin{align*}
  \hat y_{1,T+1|T} &amp;=\hat{c}_1+\hat\phi_{11,1}y_{1,T}+\hat\phi_{12,1}y_{2,T} \\
  \hat y_{2,T+1|T} &amp;=\hat{c}_2+\hat\phi _{21,1}y_{1,T}+\hat\phi_{22,1}y_{2,T}.
\end{align*}\]</span></p>
<p>This is the same form as <a href="VAR.html#eq:var1a">(11.1)</a>–<a href="VAR.html#eq:var1b">(11.2)</a>, except that the errors have been set to zero and parameters have been replaced with their estimates. For <span class="math inline">\(h=2\)</span>, the forecasts are given by
<span class="math display">\[\begin{align*}
  \hat y_{1,T+2|T} &amp;=\hat{c}_1+\hat\phi_{11,1}\hat y_{1,T+1}+\hat\phi_{12,1}\hat y_{2,T+1}\\
  \hat y_{2,T+2|T}&amp;=\hat{c}_2+\hat\phi_{21,1}\hat y_{1,T+1}+\hat\phi_{22,1}\hat y_{2,T+1}.
\end{align*}\]</span>
Again, this is the same form as <a href="VAR.html#eq:var1a">(11.1)</a>–<a href="VAR.html#eq:var1b">(11.2)</a>, except that the errors have been set to zero, parameters have been replaced with their estimates, and the unknown values of <span class="math inline">\(y_1\)</span> and <span class="math inline">\(y_2\)</span> have been replaced with their forecasts. The process can be iterated in this manner for all future time periods.</p>
<p>There are two decisions one has to make when using a VAR to forecast. They are, how many variables (denoted by <span class="math inline">\(K\)</span>) and how many lags (denoted by <span class="math inline">\(p\)</span>) should be included in the system. The number of coefficients to be estimated in a VAR is equal to <span class="math inline">\(K+pK^2\)</span> (or <span class="math inline">\(1+pK\)</span> per equation). For example, for a VAR with <span class="math inline">\(K=5\)</span> variables and <span class="math inline">\(p=3\)</span> lags, there are 16 coefficients per equation making for a total of 80 coefficients to be estimated. The more coefficients to be estimated the larger the estimation error entering the forecast.</p>
<p>In practice it is usual to keep <span class="math inline">\(K\)</span> small and include only variables that are correlated to each other and therefore useful in forecasting each other. Information criteria are commonly used to select the number of lags to be included.</p>
<p>VARs are implemented in the <strong>vars</strong> package in R. It contains a function <code>VARselect</code> to choose the number of lags <span class="math inline">\(p\)</span> using four different information criteria: AIC, HQ, SC and FPE. We have met the AIC before, and SC is simply another name for the BIC (SC stands for Schwarz Criterion after Gideon Schwarz who proposed it). HQ is the Hannan-Quinn criterion and FPE is the “Final Prediction Error” criterion.<a href="#fn25" class="footnote-ref" id="fnref25"><sup>25</sup></a> Care should be taken using the AIC as it tends to choose large numbers of lags. Instead, for VAR models, we prefer to use the BIC.</p>
<p>A criticism VARs face is that they are atheoretical. They are not built on some economic theory that imposes a theoretical structure to the equations. Every variable is assumed to influence every other variable in the system, which makes direct interpretation of the estimated coefficients very difficult. Despite this, VARs are useful in several contexts:</p>
<ul>
<li>forecasting a collection of related variables where no explicit interpretation is required;</li>
<li>testing whether one variable is useful in forecasting another (the basis of Granger causality tests);</li>
<li>impulse response analysis, where the response of one variable to a sudden but temporary change in another variable is analysed;</li>
<li>forecast error variance decomposition, where the proportion of the forecast variance of one variable is attributed to the effect of other variables.</li>
</ul>
<div id="example-a-var-model-for-forecasting-us-consumption" class="section level3 unnumbered">
<h3>Example: A VAR model for forecasting US consumption</h3>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb215-1" data-line-number="1"><span class="kw">library</span>(vars)</a>
<a class="sourceLine" id="cb215-2" data-line-number="2"><span class="co">#&gt; Loading required package: MASS</span></a>
<a class="sourceLine" id="cb215-3" data-line-number="3"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb215-4" data-line-number="4"><span class="co">#&gt; Attaching package: &#39;MASS&#39;</span></a>
<a class="sourceLine" id="cb215-5" data-line-number="5"><span class="co">#&gt; The following object is masked from &#39;package:dplyr&#39;:</span></a>
<a class="sourceLine" id="cb215-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb215-7" data-line-number="7"><span class="co">#&gt;     select</span></a>
<a class="sourceLine" id="cb215-8" data-line-number="8"><span class="co">#&gt; The following objects are masked from &#39;package:fma&#39;:</span></a>
<a class="sourceLine" id="cb215-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb215-10" data-line-number="10"><span class="co">#&gt;     cement, housing, petrol</span></a>
<a class="sourceLine" id="cb215-11" data-line-number="11"><span class="co">#&gt; Loading required package: strucchange</span></a>
<a class="sourceLine" id="cb215-12" data-line-number="12"><span class="co">#&gt; Loading required package: sandwich</span></a>
<a class="sourceLine" id="cb215-13" data-line-number="13"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb215-14" data-line-number="14"><span class="co">#&gt; Attaching package: &#39;strucchange&#39;</span></a>
<a class="sourceLine" id="cb215-15" data-line-number="15"><span class="co">#&gt; The following object is masked from &#39;package:stringr&#39;:</span></a>
<a class="sourceLine" id="cb215-16" data-line-number="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb215-17" data-line-number="17"><span class="co">#&gt;     boundary</span></a>
<a class="sourceLine" id="cb215-18" data-line-number="18"><span class="co">#&gt; Loading required package: urca</span></a>
<a class="sourceLine" id="cb215-19" data-line-number="19"><span class="co">#&gt; Loading required package: lmtest</span></a></code></pre></div>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb216-1" data-line-number="1"><span class="kw">VARselect</span>(uschange[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">lag.max=</span><span class="dv">8</span>, <span class="dt">type=</span><span class="st">&quot;const&quot;</span>)[[<span class="st">&quot;selection&quot;</span>]]</a>
<a class="sourceLine" id="cb216-2" data-line-number="2"><span class="co">#&gt; AIC(n)  HQ(n)  SC(n) FPE(n) </span></a>
<a class="sourceLine" id="cb216-3" data-line-number="3"><span class="co">#&gt;      5      1      1      5</span></a>
<a class="sourceLine" id="cb216-4" data-line-number="4"></a>
<a class="sourceLine" id="cb216-5" data-line-number="5">var &lt;-<span class="st"> </span><span class="kw">VAR</span>(uschange[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], <span class="dt">p=</span><span class="dv">3</span>, <span class="dt">type=</span><span class="st">&quot;const&quot;</span>)</a>
<a class="sourceLine" id="cb216-6" data-line-number="6"><span class="kw">serial.test</span>(var, <span class="dt">lags.pt=</span><span class="dv">10</span>, <span class="dt">type=</span><span class="st">&quot;PT.asymptotic&quot;</span>)</a>
<a class="sourceLine" id="cb216-7" data-line-number="7"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-8" data-line-number="8"><span class="co">#&gt;  Portmanteau Test (asymptotic)</span></a>
<a class="sourceLine" id="cb216-9" data-line-number="9"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-10" data-line-number="10"><span class="co">#&gt; data:  Residuals of VAR object var</span></a>
<a class="sourceLine" id="cb216-11" data-line-number="11"><span class="co">#&gt; Chi-squared = 34, df = 28, p-value = 0.2</span></a>
<a class="sourceLine" id="cb216-12" data-line-number="12"></a>
<a class="sourceLine" id="cb216-13" data-line-number="13"><span class="kw">summary</span>(var)</a>
<a class="sourceLine" id="cb216-14" data-line-number="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-15" data-line-number="15"><span class="co">#&gt; VAR Estimation Results:</span></a>
<a class="sourceLine" id="cb216-16" data-line-number="16"><span class="co">#&gt; ========================= </span></a>
<a class="sourceLine" id="cb216-17" data-line-number="17"><span class="co">#&gt; Endogenous variables: Consumption, Income </span></a>
<a class="sourceLine" id="cb216-18" data-line-number="18"><span class="co">#&gt; Deterministic variables: const </span></a>
<a class="sourceLine" id="cb216-19" data-line-number="19"><span class="co">#&gt; Sample size: 184 </span></a>
<a class="sourceLine" id="cb216-20" data-line-number="20"><span class="co">#&gt; Log Likelihood: -380.155 </span></a>
<a class="sourceLine" id="cb216-21" data-line-number="21"><span class="co">#&gt; Roots of the characteristic polynomial:</span></a>
<a class="sourceLine" id="cb216-22" data-line-number="22"><span class="co">#&gt; 0.782 0.498 0.498 0.444 0.286 0.286</span></a>
<a class="sourceLine" id="cb216-23" data-line-number="23"><span class="co">#&gt; Call:</span></a>
<a class="sourceLine" id="cb216-24" data-line-number="24"><span class="co">#&gt; VAR(y = uschange[, 1:2], p = 3, type = &quot;const&quot;)</span></a>
<a class="sourceLine" id="cb216-25" data-line-number="25"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-26" data-line-number="26"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-27" data-line-number="27"><span class="co">#&gt; Estimation results for equation Consumption: </span></a>
<a class="sourceLine" id="cb216-28" data-line-number="28"><span class="co">#&gt; ============================================ </span></a>
<a class="sourceLine" id="cb216-29" data-line-number="29"><span class="co">#&gt; Consumption = Consumption.l1 + Income.l1 + Consumption.l2 + Income.l2 + Consumption.l3 + Income.l3 + const </span></a>
<a class="sourceLine" id="cb216-30" data-line-number="30"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-31" data-line-number="31"><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb216-32" data-line-number="32"><span class="co">#&gt; Consumption.l1   0.1910     0.0796    2.40  0.01752 *  </span></a>
<a class="sourceLine" id="cb216-33" data-line-number="33"><span class="co">#&gt; Income.l1        0.0784     0.0545    1.44  0.15245    </span></a>
<a class="sourceLine" id="cb216-34" data-line-number="34"><span class="co">#&gt; Consumption.l2   0.1595     0.0825    1.93  0.05479 .  </span></a>
<a class="sourceLine" id="cb216-35" data-line-number="35"><span class="co">#&gt; Income.l2       -0.0271     0.0572   -0.47  0.63683    </span></a>
<a class="sourceLine" id="cb216-36" data-line-number="36"><span class="co">#&gt; Consumption.l3   0.2265     0.0797    2.84  0.00502 ** </span></a>
<a class="sourceLine" id="cb216-37" data-line-number="37"><span class="co">#&gt; Income.l3       -0.0145     0.0543   -0.27  0.78906    </span></a>
<a class="sourceLine" id="cb216-38" data-line-number="38"><span class="co">#&gt; const            0.2908     0.0830    3.50  0.00058 ***</span></a>
<a class="sourceLine" id="cb216-39" data-line-number="39"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb216-40" data-line-number="40"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb216-41" data-line-number="41"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-42" data-line-number="42"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-43" data-line-number="43"><span class="co">#&gt; Residual standard error: 0.595 on 177 degrees of freedom</span></a>
<a class="sourceLine" id="cb216-44" data-line-number="44"><span class="co">#&gt; Multiple R-Squared: 0.213,   Adjusted R-squared: 0.187 </span></a>
<a class="sourceLine" id="cb216-45" data-line-number="45"><span class="co">#&gt; F-statistic: 7.99 on 6 and 177 DF,  p-value: 1.22e-07 </span></a>
<a class="sourceLine" id="cb216-46" data-line-number="46"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-47" data-line-number="47"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-48" data-line-number="48"><span class="co">#&gt; Estimation results for equation Income: </span></a>
<a class="sourceLine" id="cb216-49" data-line-number="49"><span class="co">#&gt; ======================================= </span></a>
<a class="sourceLine" id="cb216-50" data-line-number="50"><span class="co">#&gt; Income = Consumption.l1 + Income.l1 + Consumption.l2 + Income.l2 + Consumption.l3 + Income.l3 + const </span></a>
<a class="sourceLine" id="cb216-51" data-line-number="51"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-52" data-line-number="52"><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)    </span></a>
<a class="sourceLine" id="cb216-53" data-line-number="53"><span class="co">#&gt; Consumption.l1   0.4535     0.1156    3.92  0.00013 ***</span></a>
<a class="sourceLine" id="cb216-54" data-line-number="54"><span class="co">#&gt; Income.l1       -0.2730     0.0791   -3.45  0.00070 ***</span></a>
<a class="sourceLine" id="cb216-55" data-line-number="55"><span class="co">#&gt; Consumption.l2   0.0217     0.1198    0.18  0.85666    </span></a>
<a class="sourceLine" id="cb216-56" data-line-number="56"><span class="co">#&gt; Income.l2       -0.0900     0.0831   -1.08  0.27979    </span></a>
<a class="sourceLine" id="cb216-57" data-line-number="57"><span class="co">#&gt; Consumption.l3   0.3538     0.1157    3.06  0.00257 ** </span></a>
<a class="sourceLine" id="cb216-58" data-line-number="58"><span class="co">#&gt; Income.l3       -0.0538     0.0787   -0.68  0.49570    </span></a>
<a class="sourceLine" id="cb216-59" data-line-number="59"><span class="co">#&gt; const            0.3875     0.1205    3.22  0.00154 ** </span></a>
<a class="sourceLine" id="cb216-60" data-line-number="60"><span class="co">#&gt; ---</span></a>
<a class="sourceLine" id="cb216-61" data-line-number="61"><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></a>
<a class="sourceLine" id="cb216-62" data-line-number="62"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-63" data-line-number="63"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-64" data-line-number="64"><span class="co">#&gt; Residual standard error: 0.864 on 177 degrees of freedom</span></a>
<a class="sourceLine" id="cb216-65" data-line-number="65"><span class="co">#&gt; Multiple R-Squared: 0.175,   Adjusted R-squared: 0.148 </span></a>
<a class="sourceLine" id="cb216-66" data-line-number="66"><span class="co">#&gt; F-statistic: 6.28 on 6 and 177 DF,  p-value: 5.31e-06 </span></a>
<a class="sourceLine" id="cb216-67" data-line-number="67"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-68" data-line-number="68"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-69" data-line-number="69"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-70" data-line-number="70"><span class="co">#&gt; Covariance matrix of residuals:</span></a>
<a class="sourceLine" id="cb216-71" data-line-number="71"><span class="co">#&gt;             Consumption Income</span></a>
<a class="sourceLine" id="cb216-72" data-line-number="72"><span class="co">#&gt; Consumption       0.355  0.185</span></a>
<a class="sourceLine" id="cb216-73" data-line-number="73"><span class="co">#&gt; Income            0.185  0.747</span></a>
<a class="sourceLine" id="cb216-74" data-line-number="74"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb216-75" data-line-number="75"><span class="co">#&gt; Correlation matrix of residuals:</span></a>
<a class="sourceLine" id="cb216-76" data-line-number="76"><span class="co">#&gt;             Consumption Income</span></a>
<a class="sourceLine" id="cb216-77" data-line-number="77"><span class="co">#&gt; Consumption       1.000  0.359</span></a>
<a class="sourceLine" id="cb216-78" data-line-number="78"><span class="co">#&gt; Income            0.359  1.000</span></a></code></pre></div>
<p>The R output on the following page shows the lag length selected by each of the information criteria available in the <strong>vars</strong> package. There is a large discrepancy between a VAR(5) selected by the AIC and a VAR(1) selected by the BIC. This is not unusual. As a result we first fit a VAR(1), selected by the BIC. In similar fashion to the univariate ARIMA methodology we test that the residuals are uncorrelated using a Portmanteau test<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a> The null hypothesis of no serial correlation in the residuals is rejected for both a VAR(1) and a VAR(2) and therefore we fit a VAR(3) as now the null is not rejected. The forecasts generated by the VAR(3) are plotted in Figure <a href="#fig:VAR3"><strong>??</strong></a>.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb217-1" data-line-number="1"><span class="co"># forecast(var) %&gt;%</span></a>
<a class="sourceLine" id="cb217-2" data-line-number="2"><span class="co">#   autoplot() + xlab(&quot;Year&quot;)</span></a></code></pre></div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="23">
<li id="fn23"><p>A more flexible generalisation would be a Vector ARMA process. However, the relative simplicity of VARs has led to their dominance in forecasting. Interested readers may refer to <span class="citation">Athanasopoulos, Poskitt, and Vahid (<a href="#ref-AthEtAl2012">2012</a>)</span>.<a href="VAR.html#fnref23" class="footnote-back">↩</a></p></li>
<li id="fn24"><p>Interested readers should refer to <span class="citation">Hamilton (<a href="#ref-Ham1994">1994</a>)</span> and <span class="citation">Lütkepohl (<a href="#ref-Lut2007">2007</a>)</span>.<a href="VAR.html#fnref24" class="footnote-back">↩</a></p></li>
<li id="fn25"><p>For a detailed comparison of these criteria, see Chapter 4.3 of <span class="citation">Lütkepohl (<a href="#ref-Lut2005">2005</a>)</span>.<a href="VAR.html#fnref25" class="footnote-back">↩</a></p></li>
<li id="fn26"><p>The tests for serial correlation in the “vars” package are multivariate generalisations of the tests presented in Section <a href="residuals.html#residuals">3.3</a>.<a href="VAR.html#fnref26" class="footnote-back">↩</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="forecasting-counts.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-9-3-nnet.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/robjhyndman/fpp2/edit/master/11-advanced.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
